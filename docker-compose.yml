version: '3.4'

services:
    postgres:
        image: postgres:12
        restart: always
        expose:
            - '5432'
        environment:
            - POSTGRES_PASSWORD=temp
            - POSTGRES_USER=temp
            - POSTGRES_DB=comisaria_virtual
            - TZ=Chile/Continental
            - PGTZ=Chile/Continental
        volumes:
            - ./postgres_scripts:/docker-entrypoint-initdb.d/
    backend:
        build:
            context: ./backend
            target: development
        image: backend:dev
        ports:
            - '3000:3000'
        environment:
            - PGUSER=temp
            - PGHOST=postgres
            - PGPASSWORD=temp
            - PGDATABASE=comisaria_virtual
            - PGPORT=5432
            - EXPRESSPORT=3000
        volumes:
            - ./backend:/code
        depends_on:
            - postgres
